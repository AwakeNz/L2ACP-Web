@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer

<div class="wrapper wrapper-content animated fadeIn">
    <div class="row">
        <div class="col-lg-12">
            <div class="tabs-container">
                <ul class="nav nav-tabs">
                    <li class="active"><a data-toggle="tab" href="#tab-1">@Localizer["Announcements"]</a></li>
                    <li><a data-toggle="tab" href="#tab-2">@Localizer["Server"]</a></li>
                </ul>
                <div class="tab-content">
                    <div id="tab-1" class="tab-pane active">
                        <div class="panel-body">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <h5>@Localizer["Announce to all"]</h5>
                                </div>
                                <div class="ibox-content">
                                    <div class="form-group">
                                        <input id="announceText" type="text" placeholder="@Localizer["Announcement text"]" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <button type="button" id="announce" class="btn btn-primary">@Localizer["Announce"]</button>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div id="tab-2" class="tab-pane">
                        <div class="panel-body">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <h5>@Localizer["Restart server"]</h5>
                                </div>
                                <div class="ibox-content">
                                    <div class="form-group">
                                        <input id="restartSeconds" type="number" placeholder="@Localizer["Seconds until restart (0 is instant)"]" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <button type="button" id="restartServer" class="btn btn-primary">@Localizer["Restart Server"]</button>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

    $('#announce').click(function() {
        var announceText = $('#announceText').val();
        if (announceText.trim().length == 0) {
            toastr["error"]("@Localizer["You have to write something there."]");
        }
        $.post("/admin/announce", { 'annText' : announceText}, function( data ) {
            if (data.startsWith("ok:")) {
                toastr["success"](data.replace("ok:", ""));
                $('#announceText').val('');
            } else {
                toastr["error"](data);
            }
        });
    });

    $('#restartServer').click(function() {
        var restartSeconds = $('#restartSeconds').val();
        if (restartSeconds == "" || restartSeconds == null) {
            restartSeconds = 0;
        }
        $.post("/admin/serverrestart", { 'restartseconds': restartSeconds}, function( data ) {
            if (data.startsWith("ok:")) {
                toastr["success"](data.replace("ok:", ""));
                $('#announceText').val('');
            } else {
                toastr["error"](data);
            }
        });
    });
</script>